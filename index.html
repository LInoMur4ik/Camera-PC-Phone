<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Транслятор (Телефон)</title>
    <style>
        body { font-family: sans-serif; text-align: center; background: #121212; color: white; }
        video { width: 90%; border-radius: 10px; background: #000; margin-top: 20px; }
        input { padding: 10px; width: 80%; margin: 10px 0; border-radius: 5px; border: none; }
    </style>
</head>
<body>
    <h1>Трансляция</h1>
    <input type="text" id="roomId" placeholder="Введите имя комнаты (например, room123)">
    <br>
    <video id="localVideo" autoplay playsinline muted></video>
    
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <script>
        const videoElement = document.getElementById('localVideo');
        const inputId = document.getElementById('roomId');
        let peer = null;

        navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" }, audio: true })
            .then(stream => {
                videoElement.srcObject = stream;

                // Как только ввели ID, инициализируем Peer
                inputId.addEventListener('change', () => {
                    if (peer) peer.destroy();
                    
                    peer = new Peer(inputId.value);
                    
                    peer.on('open', (id) => {
                        alert('Комната создана: ' + id + '. Теперь введи это имя на компьютере.');
                    });

                    peer.on('call', call => {
                        call.answer(stream);
                    });
                });
            });
    </script>
</body>
</html>